<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    {% extends "layout.html" %}
    <div class="playlist">
      {% block content %} {% for playlist in items %}
      <div id="playlist-{{playlist.PlaylistID}}">
        {% if playlist.Title %}

        <h3>{{playlist.Title}}</h3>
        {% if playlist.Songs %} {% for song in playlist.Songs %} {{
        playlist.Songs }} {% endfor %} {% endif %} {% endif %}
        <div>
          <a href="/playlist/{{playlist.PlaylistID}}">Edit playlist</a>
        </div>
        <div>
          <script defer>
            // Get the form

            // Get all field data from the form
            // returns a FormData object
            document.addEventListener("DOMContentLoaded", async () => {
              await document
                .getElementById("button-{{playlist.PlaylistID}}")
                .addEventListener("click", (e) => {
                  e.preventDefault();
                  fetch("/playlist/delete/{{playlist.PlaylistID}}", {
                    method: "DELETE",
                  });
                  document
                    .getElementById("playlist-{{playlist.PlaylistID}}")
                    .remove();
                });
            });
          </script>
          <button
            id="button-{{playlist.PlaylistID}}"
            data-id="{{ playlist.PlaylistID }}"
          >
            Delete playlist
          </button>
        </div>
      </div>
      {% endfor %}
    </div>
    {% endblock %}
  </body>
</html>
